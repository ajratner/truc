
  deepdive.db.default {
    driver: "org.postgresql.Driver"
    url: "jdbc:postgresql://"${PGHOST}":"${PGPORT}"/"${DBNAME}
    user: ${PGUSER}
    password: ${PGPASSWORD}
    dbname: ${DBNAME}
    host: ${PGHOST}
    port: ${PGPORT}
    incremental_mode: ORIGINAL
    }
    


      deepdive.schema.variables {
        
      }
    

          deepdive.extraction.extractors.extraction_rule_2 {
            sql: """ DROP TABLE IF EXISTS pheno_mentions CASCADE;
            CREATE TABLE
            pheno_mentions(mention_id text,
              table_id text,
              cell_id int,
              word_idxs int[],
              entity text,
              type text,
              is_correct boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.extraction_rule_0 {
            sql: """ DROP TABLE IF EXISTS cells CASCADE;
            CREATE TABLE
            cells(table_id text,
     cell_id int,
     words text[],
     type text,
     attributes text[],
     xpos int,
     xspan int,
     ypos int,
     yspan int)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.extraction_rule_1 {
            sql: """ DROP TABLE IF EXISTS gene_mentions CASCADE;
            CREATE TABLE
            gene_mentions(mention_id text,
             table_id text,
             cell_id int,
             word_idxs int[],
             entity text,
             type text,
             is_correct boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.extraction_rule_3 {
            sql: """ DROP TABLE IF EXISTS genepheno_relations CASCADE;
            CREATE TABLE
            genepheno_relations(relation_id text,
                   table_id text,
                   gene_mention_id text,
                   pheno_mention_id text,
                   type text,
                   is_correct boolean)
            """
            style: "sql_extractor"
          }

        deepdive.extraction.extractors.cleanup {
          sql: """
          TRUNCATE pheno_mentions;
          TRUNCATE cells;
          TRUNCATE gene_mentions;
          TRUNCATE genepheno_relations;
          """
          style: "sql_extractor"
        }

      deepdive.extraction.extractors.extraction_rule_8 {
        sql: """ DROP VIEW IF EXISTS ext_pheno_mentions_input;
        CREATE VIEW ext_pheno_mentions_input AS 
            SELECT R0.table_id AS "cells.R0.table_id" , R0.cell_id AS "cells.R0.cell_id" , ARRAY_TO_STRING(R0.words, '|^|') AS "column_2" 
            FROM cells R0
        
        """
        style: "sql_extractor"
          
      }
    

      deepdive.extraction.extractors.extraction_rule_11 {
        sql: """ DROP VIEW IF EXISTS ext_genepheno_relations_input;
        CREATE VIEW ext_genepheno_relations_input AS 
            SELECT R0.table_id AS "gene_mentions.R0.table_id" , R0.mention_id AS "gene_mentions.R0.mention_id" , R0.cell_id AS "gene_mentions.R0.cell_id" , ARRAY_TO_STRING(R0.word_idxs, '|^|') AS "column_3" , R0.entity AS "gene_mentions.R0.entity" , ARRAY_TO_STRING(R2.words, '|^|') AS "column_5" , R2.type AS "cells.R2.type" , ARRAY_TO_STRING(R2.attributes, '|^|') AS "column_7" , R2.xpos AS "cells.R2.xpos" , R2.xspan AS "cells.R2.xspan" , R2.ypos AS "cells.R2.ypos" , R2.yspan AS "cells.R2.yspan" , R1.mention_id AS "pheno_mentions.R1.mention_id" , R1.cell_id AS "pheno_mentions.R1.cell_id" , ARRAY_TO_STRING(R1.word_idxs, '|^|') AS "column_14" , R1.entity AS "pheno_mentions.R1.entity" , ARRAY_TO_STRING(R3.words, '|^|') AS "column_16" , R3.type AS "cells.R3.type" , ARRAY_TO_STRING(R3.attributes, '|^|') AS "column_18" , R3.xpos AS "cells.R3.xpos" , R3.xspan AS "cells.R3.xspan" , R3.ypos AS "cells.R3.ypos" , R3.yspan AS "cells.R3.yspan" 
            FROM gene_mentions R0, pheno_mentions R1, cells R2, cells R3
        WHERE R1.table_id = R0.table_id  AND R2.table_id = R0.table_id  AND R2.cell_id = R0.cell_id  AND R3.table_id = R0.table_id  AND R3.cell_id = R1.cell_id 
        """
        style: "sql_extractor"
          dependencies: [ "extraction_rule_6" ,  "extraction_rule_9" ]
      }
    

      deepdive.extraction.extractors.extraction_rule_5 {
        sql: """ DROP VIEW IF EXISTS ext_gene_mentions_input;
        CREATE VIEW ext_gene_mentions_input AS 
            SELECT R0.table_id AS "cells.R0.table_id" , R0.cell_id AS "cells.R0.cell_id" , ARRAY_TO_STRING(R0.words, '|^|') AS "column_2" 
            FROM cells R0
        
        """
        style: "sql_extractor"
          
      }
    

        deepdive.extraction.extractors.extraction_rule_9 {
          input: """ SELECT * FROM ext_pheno_mentions_input
          """
          output_relation: "pheno_mentions"
          udf: ${APP_HOME}"/udf/extract_pheno_mentions.py"
          style: "tsv_extractor" 
          dependencies: [ "extraction_rule_8" ]
        }
      

        deepdive.extraction.extractors.extraction_rule_12 {
          input: """ SELECT * FROM ext_genepheno_relations_input
          """
          output_relation: "genepheno_relations"
          udf: ${APP_HOME}"/udf/extract_genepheno_relations.py"
          style: "tsv_extractor" 
          dependencies: [ "extraction_rule_11" ]
        }
      

        deepdive.extraction.extractors.extraction_rule_6 {
          input: """ SELECT * FROM ext_gene_mentions_input
          """
          output_relation: "gene_mentions"
          udf: ${APP_HOME}"/udf/extract_gene_mentions.py"
          style: "tsv_extractor" 
          dependencies: [ "extraction_rule_5" ]
        }
      
deepdive.pipeline.run: ${PIPELINE}
deepdive.pipeline.pipelines.initdb: [extraction_rule_2, extraction_rule_0, extraction_rule_1, extraction_rule_3]
deepdive.pipeline.pipelines.extraction: [extraction_rule_12, extraction_rule_8, extraction_rule_5, extraction_rule_9, extraction_rule_11, extraction_rule_6]
deepdive.pipeline.pipelines.endtoend: [extraction_rule_12, extraction_rule_8, extraction_rule_5, extraction_rule_9, extraction_rule_11, extraction_rule_6]
deepdive.pipeline.pipelines.cleanup: [cleanup]
